name: Daily Operations

on:
  schedule:
    # –û–¥–∏–Ω –æ–±—â–∏–π –∑–∞–ø—É—Å–∫ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 06:00 UTC (09:00 –ø–æ –ú–æ—Å–∫–≤–µ)
    - cron: '0 6 * * *'
  workflow_dispatch:

jobs:
  daily-operations:
    runs-on: ubuntu-latest
    env:
      BOT_TOKEN: ${{ secrets.BOT_TOKEN }}
      CHAT_ID: ${{ secrets.CHAT_ID }}
      ANNOUNCEMENTS_TOPIC_ID: ${{ secrets.ANNOUNCEMENTS_TOPIC_ID }}
      GAMES_TOPIC_ID: ${{ secrets.GAMES_TOPIC_ID }}
      TARGET_TEAMS: ${{ secrets.TARGET_TEAMS }}
      GOOGLE_SHEETS_CREDENTIALS: ${{ secrets.GOOGLE_SHEETS_CREDENTIALS }}
      SPREADSHEET_ID: ${{ secrets.SPREADSHEET_ID }}
      TEST_MODE: "false"

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements-github.txt

      - name: Send birthday notifications
        run: |
          echo "üéÇ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–Ω–µ–π —Ä–æ–∂–¥–µ–Ω–∏—è"
          python run_birthday_notifications.py

      - name: Run voting polls manager
        run: |
          echo "üìä –ó–∞–ø—É—Å–∫ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–π"
          python training_polls_enhanced.py

      - name: Run game system manager
        run: |
          echo "üèÄ –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–∞–º–∏"
          python run_game_system.py
