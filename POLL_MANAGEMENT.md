# Управление опросами

## Защита от дублирования

Система использует несколько уровней защиты от создания дублирующих опросов:

### 1. Локальная история (game_polls_history.json)
- Файл хранится локально и не синхронизируется с Git
- Содержит информацию о созданных опросах
- Работает только в локальной среде

### 2. Проверка времени игры
- Система не создает опросы для игр, которые прошли более 2 часов назад
- Это защищает от создания опросов для прошедших игр

### 3. Расширенное временное окно
- Создание опросов: 10:00-18:00 МСК
- Отправка анонсов: 10:00-18:00 МСК

## Проблема с GitHub Actions

В GitHub Actions каждый запуск происходит в чистой среде, поэтому:
- Файл `game_polls_history.json` не сохраняется между запусками
- Система может создавать дублирующие опросы

## Решения

### Вариант 1: Ручное управление (рекомендуется)
1. После создания опросов в GitHub Actions, добавьте их в список `existing_polls` в коде
2. Обновите код и зафиксируйте изменения

### Вариант 2: Автоматическое решение
Можно добавить проверку существующих опросов в чате Telegram, но это требует дополнительной разработки.

## Текущие опросы (обновлено 25.08.2025)

Следующие игры уже имеют опросы:
- 27.08.2025 20:30 - Кудрово vs Pull Up
- 27.08.2025 21:45 - Old Stars vs Pull Up  
- 30.08.2025 12:30 - Тосно vs Pull Up

## Инструкции по обновлению

1. После создания новых опросов в GitHub Actions
2. Добавьте их дату и время в список `existing_polls` в функции `should_create_poll`
3. Зафиксируйте изменения в Git
4. Отправьте в репозиторий

Пример:
```python
existing_polls = [
    "27.08.2025_20:30",  # Кудрово vs Pull Up
    "27.08.2025_21:45",  # Old Stars vs Pull Up  
    "30.08.2025_12:30",  # Тосно vs Pull Up
    "НОВАЯ_ДАТА_НОВОЕ_ВРЕМЯ",  # Новая игра
]
```
