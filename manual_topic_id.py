#!/usr/bin/env python3
"""
Ð ÑƒÑ‡Ð½Ð¾Ð¹ ÑÐ¿Ð¾ÑÐ¾Ð± Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ ID Ñ‚Ð¾Ð¿Ð¸ÐºÐ° "ÐÐÐžÐÐ¡Ð« Ð¢Ð Ð•ÐÐ˜Ð ÐžÐ’ÐžÐš"
"""

import os
from dotenv import load_dotenv

# Ð—Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ
load_dotenv()

def show_instructions():
    """ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ð¸ Ð¿Ð¾ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸ÑŽ ID Ñ‚Ð¾Ð¿Ð¸ÐºÐ°"""
    
    bot_token = os.getenv('BOT_TOKEN')
    
    print("ðŸ“± Ð Ð£Ð§ÐÐžÐ™ Ð¡ÐŸÐžÐ¡ÐžÐ‘ ÐŸÐžÐ›Ð£Ð§Ð•ÐÐ˜Ð¯ ID Ð¢ÐžÐŸÐ˜ÐšÐ")
    print("=" * 50)
    
    print("\nðŸ“‹ Ð¨Ð°Ð³ 1: ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ")
    print("1. ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ Telegram")
    print("2. ÐŸÐµÑ€ÐµÐ¹Ð´Ð¸Ñ‚Ðµ Ð² Ñ‡Ð°Ñ‚ Ñ Ñ‚Ð¾Ð¿Ð¸ÐºÐ°Ð¼Ð¸")
    print("3. ÐÐ°Ð¹Ð´Ð¸Ñ‚Ðµ Ñ‚Ð¾Ð¿Ð¸Ðº 'ÐÐÐžÐÐ¡Ð« Ð¢Ð Ð•ÐÐ˜Ð ÐžÐ’ÐžÐš'")
    print("4. ÐžÑ‚Ð¿Ñ€Ð°Ð²ÑŒÑ‚Ðµ Ð›Ð®Ð‘ÐžÐ• ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¾Ñ‚ Ð±Ð¾Ñ‚Ð° Ð² ÑÑ‚Ð¾Ñ‚ Ñ‚Ð¾Ð¿Ð¸Ðº")
    print("   (Ð¼Ð¾Ð¶Ð½Ð¾ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð½Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒ 'Ñ‚ÐµÑÑ‚' Ð¸Ð»Ð¸ 'hello')")
    
    print("\nðŸ“‹ Ð¨Ð°Ð³ 2: ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ ID")
    print("ÐŸÐ¾ÑÐ»Ðµ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð¿ÐµÑ€ÐµÐ¹Ð´Ð¸Ñ‚Ðµ Ð¿Ð¾ ÑÑÑ‹Ð»ÐºÐµ:")
    if bot_token:
        print(f"ðŸ”— https://api.telegram.org/bot{bot_token}/getUpdates")
    else:
        print("âŒ BOT_TOKEN Ð½Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½ Ð² .env Ñ„Ð°Ð¹Ð»Ðµ")
        return
    
    print("\nðŸ“‹ Ð¨Ð°Ð³ 3: ÐŸÐ¾Ð¸ÑÐº ID")
    print("Ð’ Ð¾Ñ‚Ð²ÐµÑ‚Ðµ Ð½Ð°Ð¹Ð´Ð¸Ñ‚Ðµ JSON Ð¾Ð±ÑŠÐµÐºÑ‚ Ñ Ð²Ð°ÑˆÐ¸Ð¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸ÐµÐ¼")
    print("Ð˜Ñ‰Ð¸Ñ‚Ðµ Ð¿Ð¾Ð»Ðµ 'message_thread_id' - ÑÑ‚Ð¾ Ð¸ ÐµÑÑ‚ÑŒ ID Ñ‚Ð¾Ð¿Ð¸ÐºÐ°")
    
    print("\nðŸ“‹ ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð¾Ñ‚Ð²ÐµÑ‚Ð°:")
    print("""
{
  "ok": true,
  "result": [
    {
      "update_id": 123456789,
      "message": {
        "message_id": 123,
        "from": {...},
        "chat": {...},
        "date": 1234567890,
        "text": "Ñ‚ÐµÑÑ‚",
        "message_thread_id": 456789  â† Ð­Ð¢Ðž ID Ð¢ÐžÐŸÐ˜ÐšÐ
      }
    }
  ]
}
    """)
    
    print("\nðŸ“‹ Ð¨Ð°Ð³ 4: ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°")
    print("Ð¡ÐºÐ¾Ð¿Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ 'message_thread_id' Ð¸ Ð´Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð² .env:")
    print("ANNOUNCEMENTS_TOPIC_ID=456789")
    
    print("\nðŸ“‹ Ð¨Ð°Ð³ 5: ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ°")
    print("Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ðµ ÑÑ‚Ð¾Ñ‚ ÑÐºÑ€Ð¸Ð¿Ñ‚ ÑÐ½Ð¾Ð²Ð° Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸:")
    print("python manual_topic_id.py --check")

def check_topic_id():
    """ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚, Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½ Ð»Ð¸ ID Ñ‚Ð¾Ð¿Ð¸ÐºÐ°"""
    
    topic_id = os.getenv('ANNOUNCEMENTS_TOPIC_ID')
    
    print("ðŸ” ÐŸÐ ÐžÐ’Ð•Ð ÐšÐ ÐÐÐ¡Ð¢Ð ÐžÐ™ÐšÐ˜ ID Ð¢ÐžÐŸÐ˜ÐšÐ")
    print("=" * 40)
    
    if topic_id:
        print(f"âœ… ANNOUNCEMENTS_TOPIC_ID Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½: {topic_id}")
        print("\nðŸ“ Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð¼Ð¾Ð¶Ð½Ð¾ Ð¿Ñ€Ð¾Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÑƒ:")
        print("python test_topic_send.py")
    else:
        print("âŒ ANNOUNCEMENTS_TOPIC_ID Ð½Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐ½")
        print("\nðŸ“ Ð¡Ð»ÐµÐ´ÑƒÐ¹Ñ‚Ðµ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸ÑÐ¼ Ð²Ñ‹ÑˆÐµ Ð´Ð»Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸")

if __name__ == "__main__":
    import sys
    
    if len(sys.argv) > 1 and sys.argv[1] == "--check":
        check_topic_id()
    else:
        show_instructions()
