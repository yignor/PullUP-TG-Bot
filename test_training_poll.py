#!/usr/bin/env python3
"""
–¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è –æ–ø—Ä–æ—Å–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
"""

import os
import asyncio
from telegram import Bot
from dotenv import load_dotenv

# –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
load_dotenv()

async def test_training_poll():
    """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –æ–ø—Ä–æ—Å–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫"""
    
    # –ü–æ–ª—É—á–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    bot_token = os.getenv('BOT_TOKEN')
    chat_id = os.getenv('CHAT_ID')
    topic_id = os.getenv('ANNOUNCEMENTS_TOPIC_ID')
    
    print("üß™ –¢–ï–°–¢ –°–û–ó–î–ê–ù–ò–Ø –û–ü–†–û–°–ê –¢–†–ï–ù–ò–†–û–í–û–ö")
    print("=" * 40)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    if not bot_token:
        print("‚ùå BOT_TOKEN –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω")
        return
    
    if not chat_id:
        print("‚ùå CHAT_ID –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω")
        return
    
    if not topic_id:
        print("‚ùå ANNOUNCEMENTS_TOPIC_ID –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω")
        return
    
    print(f"‚úÖ BOT_TOKEN: {'*' * 10}{bot_token[-4:]}")
    print(f"‚úÖ CHAT_ID: {chat_id}")
    print(f"‚úÖ ANNOUNCEMENTS_TOPIC_ID: {topic_id}")
    
    bot = Bot(token=bot_token)
    
    # –í–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ –¥–ª—è –æ–ø—Ä–æ—Å–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫
    training_options = [
        "üèÄ –í—Ç–æ—Ä–Ω–∏–∫ 19:00",
        "üèÄ –ü—è—Ç–Ω–∏—Ü–∞ 20:30",
        "üë®‚Äçüè´ –¢—Ä–µ–Ω–µ—Ä",
        "‚ùå –ù–µ—Ç"
    ]
    
    try:
        print("\nüì§ –°–æ–∑–¥–∞—é –æ–ø—Ä–æ—Å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫...")
        
        # –°–æ–∑–¥–∞–µ–º –æ–ø—Ä–æ—Å —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –≤—ã–±–æ—Ä–æ–º
        poll = await bot.send_poll(
            chat_id=chat_id,
            question="üèÄ –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –Ω–∞ –Ω–µ–¥–µ–ª–µ –°–®–û–† –í–û",
            options=training_options,
            allows_multiple_answers=True,
            is_anonymous=False,  # –û—Ç–∫—Ä—ã—Ç—ã–π –æ–ø—Ä–æ—Å
            explanation="–í—ã–±–µ—Ä–∏—Ç–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –ø—Ä–∏–π—Ç–∏ –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ",
            message_thread_id=int(topic_id)  # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ —Ç–æ–ø–∏–∫ "–ê–ù–û–ù–°–´ –¢–†–ï–ù–ò–†–û–í–û–ö"
        )
        
        print(f"‚úÖ –û–ø—Ä–æ—Å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ —Å–æ–∑–¥–∞–Ω!")
        print(f"üìã ID —Å–æ–æ–±—â–µ–Ω–∏—è: {poll.message_id}")
        print(f"üìã –í–æ–ø—Ä–æ—Å: {poll.poll.question}")
        print(f"üìã –í–∞—Ä–∏–∞–Ω—Ç—ã: {len(poll.poll.options)}")
        print(f"üìã –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è: {poll.date}")
        
        print("\nüéØ –°–∏—Å—Ç–µ–º–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!")
        print("üìù –û–ø—Ä–æ—Å—ã –±—É–¥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –∫–∞–∂–¥–æ–µ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ –≤ 10:00 –ø–æ –ú–æ—Å–∫–≤–µ")
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ–ø—Ä–æ—Å–∞: {e}")
        print("\nüîç –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:")
        print("1. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π ID —Ç–æ–ø–∏–∫–∞")
        print("2. –ë–æ—Ç –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –æ–ø—Ä–æ—Å–æ–≤")
        print("3. –ë–æ—Ç –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É –≤ —Ç–æ–ø–∏–∫")

if __name__ == "__main__":
    asyncio.run(test_training_poll())
